!function(d,t){var u={cache:function(){u.els={},u.vars={},u.vars.u_hide_class="iconic-was-u-hide",u.els.attribute_form=d(".product_page_product_attributes #attribute_label").closest("form"),u.els.attribute_form_submit=u.els.attribute_form.find(".submit"),u.els.product_attribute_swatch_types=d(".iconic-was-attributes__swatch-type select"),u.els.attribute_type_field=d('select[name="attribute_type"]')},on_ready:function(){u.cache(),u.setup_attribute_fields(),u.setup_product_swatch_fields()},setup_attribute_fields:function(){u.get_attribute_fields(function(t){var i=u.format_attribute_fields(t);u.els.attribute_form_submit.before(i),d("[data-conditional]").iconicConditional()}),u.els.attribute_type_field.on("change",function(){var t=d(this).val(),i=d(".iconic-was-attribute-fields");"select"===t?i.removeClass(u.vars.u_hide_class):i.addClass(u.vars.u_hide_class)}),u.setup_colour_pickers(),u.setup_image_swatch_fields()},setup_colour_pickers:function(){d(".colour-swatch-picker").wpColorPicker()},setup_image_swatch_fields:function(){var n;d(".iconic-was-image-picker__upload").on("click",function(t){t.preventDefault();var i=d(this),e=i.closest(".iconic-was-image-picker"),a=e.find(".iconic-was-image-picker__field"),c=e.find(".iconic-was-image-picker__preview"),s=e.find(".iconic-was-image-picker__remove");(n=wp.media.frames.file_frame=wp.media({title:d(this).data("title"),button:{text:d(this).data("button-text")},multiple:!1})).on("select",function(){attachment=n.state().get("selection").first().toJSON(),attachment_url=void 0!==attachment.sizes.thumbnail?attachment.sizes.thumbnail.url:attachment.url,a.val(attachment.id),c.html('<img src="'+attachment_url+'" class="attachment-thumbnail size-thumbnail">'),i.addClass("iconic-was-image-picker__upload--edit"),s.show()}),n.open()}),d(".iconic-was-image-picker__remove").on("click",function(t){t.preventDefault();var i=d(this).closest(".iconic-was-image-picker"),e=i.find(".iconic-was-image-picker__field"),a=i.find(".iconic-was-image-picker__preview"),c=i.find(".iconic-was-image-picker__upload");e.val(""),a.html(""),c.removeClass("iconic-was-image-picker__upload--edit"),d(this).hide()})},get_admin_page:function(){return!(u.els.attribute_form.length<=0)&&(0<u.els.attribute_form.find("table").length?"update":"add")},get_attribute_fields:function(i){var t={action:"iconic_was_get_attribute_fields",attribute_id:void 0!==iconic_was_vars.url_params.edit&&iconic_was_vars.url_params.edit};d.post(ajaxurl,t,function(t){if(!0!==t.success)return!1;i&&"function"==typeof i&&i(t.fields)})},format_attribute_fields:function(t){var i="",e="text"===u.els.attribute_type_field.val()?u.vars.u_hide_class:"";if("update"===u.get_admin_page()){var a=d("<table />"),r=d("<tbody />");a.attr("class","form-table iconic-was-attribute-fields "+e),d.each(t,function(t,i){var e=!!i.condition&&(d.isArray(i.condition)?JSON.stringify(i.condition):i.condition),a=JSON.stringify(i.match),c=d("<tr />"),s=d('<th scope="row" valign="top" />'),n=d("<td />");c.attr("class","iconic-was-attribute-row form-field "+i.class.join(" ")),e&&(c.attr("data-condition",e),c.attr("data-match",a)),s.append('<label for="'+t+'">'+i.label+"</label>"),n.append(i.field+'<p class="description">'+i.description+"</p>"),c.append(s,n),r.append(c)}),i=a.append(r)}else{var s=d("<div />");s.attr("class","iconic-was-attribute-fields "+e),d.each(t,function(t,i){var e=!!i.condition&&(d.isArray(i.condition)?JSON.stringify(i.condition):i.condition),a=JSON.stringify(i.match),c=d("<div />");c.attr("class","iconic-was-attribute-row form-field "+i.class.join(" ")),e&&(c.attr("data-condition",e),c.attr("data-match",a)),c.append('<label for="'+t+'">'+i.label+"</label>"),c.append(i.field+'<p class="description">'+i.description+"</p>"),s.append(c)}),i=s}return i},escape:function(t){return t.replace(/[\\]/g,"\\\\").replace(/[\"]/g,"&quot;").replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t")},setup_product_swatch_fields:function(){u.els.product_attribute_swatch_types.on("change",function(){var t=d(this),i=t.val(),e=t.find(":selected").text(),a=t.closest(".iconic-was-attribute-wrapper"),c=a.find(".iconic-was-swatch-type"),s=a.find(".iconic-was-attributes__swatch-options td"),n=parseInt(a.data("product-id")),r=a.data("taxonomy"),o=a.find(".wc-metabox-content");if(c.text(e),s.html(""),u.reset_height(o),u.is_swatch_visual(i)){var l={action:"iconic_was_get_product_attribute_fields",swatch_type:i,product_id:n,attribute_slug:r};d.post(ajaxurl,l,function(t){return!0===t.success&&(!1!==t.fields&&(s.html(t.fields),u.setup_image_swatch_fields(),u.setup_colour_pickers(),void u.reset_height(o)))})}})},is_swatch_visual:function(t){return"colour-swatch"===t||"image-swatch"===t},reset_height:function(t){t.height("")}};d(t).ready(u.on_ready())}(jQuery,document);