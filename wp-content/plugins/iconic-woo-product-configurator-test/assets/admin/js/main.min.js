!function(l,t){var e={cache:function(){e.els={},e.vars={},e.els.upload=l(".jckpc-attribute-image__upload"),e.els.remove=l(".jckpc-attribute-image__remove")},on_ready:function(){e.cache(),e.setup_image_fields()},setup_image_fields:function(){var n;e.els.upload.on("click",function(t){t.preventDefault();var e=l(this),a=e.closest(".jckpc-attribute-image"),i=a.find(".jckpc-attribute-image__field"),c=a.find(".jckpc-attribute-image__preview"),o=a.find(".jckpc-attribute-image__remove");(n=wp.media.frames.file_frame=wp.media({title:l(this).data("title"),button:{text:l(this).data("button-text")},multiple:!1})).on("select",function(){attachment=n.state().get("selection").first().toJSON(),attachment_url=void 0!==attachment.sizes.thumbnail?attachment.sizes.thumbnail.url:attachment.url,i.val(attachment.id),c.html('<img src="'+attachment_url+'" class="attachment-thumbnail size-thumbnail">'),e.addClass("jckpc-attribute-image__upload--edit"),o.show()}),n.open()}),e.els.remove.on("click",function(t){t.preventDefault();var e=l(this).closest(".jckpc-attribute-image"),a=e.find(".jckpc-attribute-image__field"),i=e.find(".jckpc-attribute-image__preview"),c=e.find(".jckpc-attribute-image__upload");a.val(""),i.html(""),c.removeClass("jckpc-attribute-image__upload--edit"),l(this).hide()})}};l(t).ready(e.on_ready())}(jQuery,document),function(n,t){var o={cache:function(){o.els={},o.vars={},o.tmpl={},o.vars.file_frame=!1,o.vars.upload_class=".jckpc-image-button--upload",o.vars.remove_class=".jckpc-image-button--remove",o.vars.collapse_class=".jckpc-layer-options__title--collapse",o.vars.conditional_group_class=".iconic-pc-conditional-group",o.vars.add_conditional_group_button_class=".iconic-pc-add-conditional-group",o.vars.add_conditional_rule_button_class=".iconic-pc-conditional-group__add-rule",o.vars.remove_conditional_group_class=".iconic-pc-conditional-group__remove",o.vars.remove_conditional_rule_class=".iconic-pc-conditional-group__rule-remove",o.vars.conditional_rule_class=".iconic-pc-conditional-group__rule",o.els.add_static_layer=n("#jckpc-add-static-layer"),o.els.sort_order_input=n("#jckpc_sort_order"),o.els.sortable_items=n("#jckpc_sortable"),o.tmpl.static_layer=wp.template("jckpc-static-layer")},on_ready:function(){o.cache(),o.setup_image_fields(),o.setup_sorting(),o.setup_collapse(),o.setup_static_layers(),o.setup_conditional_groups()},setup_image_fields:function(){n(t).on("click",o.vars.upload_class,function(t){t.preventDefault();var c=n(this);o.vars.file_frame=wp.media.frames.file_frame=wp.media({title:c.attr("data-uploader_title"),button:{text:c.attr("data-uploader_button_text")},multiple:!1,library:{type:"image/png"}}),o.vars.file_frame.on("select",function(){var t=o.vars.file_frame.state().get("selection").first().toJSON();if("image/png"===t.mime){var e=n(c.attr("data-uploader_field")),a=n(c.attr("data-uploader_field")+"_thumbwrap"),i=void 0!==t.sizes.thumbnail?t.sizes.thumbnail.url:t.url;e.val(t.id),a.prepend('<img src="'+i+'" width="80" height="80" />')}else alert(jckpc_vars.i18n.png_only)}),o.vars.file_frame.open()}),n(t).on("click",o.vars.remove_class,function(){var t=n(this).attr("data-uploader_field");return n(t).val(""),n(t+"_thumbwrap img").remove(),!1})},setup_sorting:function(){o.els.sortable_items.sortable({revert:!0,handle:".jckpc-layer-options__handle",update:function(t,e){o.update_sort_field()}})},update_sort_field:function(){if(!(o.els.sort_order_input.length<=0)){var t=o.els.sortable_items.find(".jckpc-layer-options"),e=[];t.each(function(){var t=n(this).attr("data-layer-id");e.push(t)}),o.els.sort_order_input.val(e.join(","))}},setup_collapse:function(){n(t).on("click",o.vars.collapse_class,function(){var t=n(this),e=t.find(".jckpc-layer-options__toggle");t.closest(".jckpc-layer-options").find(".jckpc-layer-options__content-wrapper").toggle(),e.toggleClass("jckpc-layer-options__toggle--collapsed")})},setup_static_layers:function(){o.els.add_static_layer.on("click",function(){n("#jckpc_sortable").prepend(o.tmpl.static_layer({index:o.get_highest_static_layer_index()+1})),o.update_sort_field()}),n(t).on("click",".jckpc-layer-options__remove",function(){n(this).closest(".jckpc-layer-options").remove(),o.update_sort_field()})},get_highest_static_layer_index:function(){var t=n("[data-static-layer-index]").map(function(){return n(this).data("static-layer-index")}).get(),e=Math.max.apply(Math,t);return e=isFinite(e)?e:-1},setup_conditional_groups:function(){n(t.body).on("click",o.vars.add_conditional_group_button_class,function(t){t.preventDefault();var e=n(this),a=e.data("iconic-pc-add-conditional-group"),i=a;e.attr("disabled",!0),void 0!==i&&(i.action="iconic_pc_get_conditional_group",i.nonce=jckpc_vars.nonce,n.post(ajaxurl,i,function(t){e.attr("disabled",!1),t.success&&(a.condition_id=parseInt(a.condition_id)+1,e.before(t.data.html).data("iconic-pc-add-conditional-group",a))}))}),n(t.body).on("click",o.vars.add_conditional_rule_button_class,function(t){t.preventDefault();var c=n(this),e=c.closest(".iconic-pc-conditional-group__rules"),a=e.find(".iconic-pc-conditional-group__rule").first().clone(),i=a.find("select"),o=parseInt(c.data("iconic-pc-rule-id"));i.val(""),i.each(function(t,e){var a=n(e),i=a.attr("name").replace("[rules][0]","[rules]["+o+"]");a.attr("name",i),c.data("iconic-pc-rule-id",o+1)}),e.find("tbody").append(a)}),n(t.body).on("click",o.vars.remove_conditional_group_class,function(t){t.preventDefault(),n(this).closest(o.vars.conditional_group_class).remove()}),n(t.body).on("click",o.vars.remove_conditional_rule_class,function(t){t.preventDefault(),n(this).closest(o.vars.conditional_rule_class).remove()})}};n(t).ready(o.on_ready())}(jQuery,document);